{"version":3,"sources":["../../../../../src/app/typescripts/pro/autocomplete/directives/input.directive.ts"],"names":[],"mappings":"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","file":"input.directive.js","sourceRoot":"","sourcesContent":["import { Directive, ElementRef, EventEmitter, Host, HostListener, Input, Output } from '@angular/core';\r\nimport { NgModel } from '@angular/forms';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { Subscription } from 'rxjs/Subscription';\r\n\r\nimport { CompleterItem } from '../components/completer-item.component';\r\nimport { MdbCompleterDirective } from './completer.directive';\r\nimport { isNil } from '../globals';\r\n\r\n\r\n\r\n// keyboard events\r\nconst KEY_DW = 40;\r\nconst KEY_RT = 39;\r\nconst KEY_UP = 38;\r\nconst KEY_LF = 37;\r\nconst KEY_ES = 27;\r\nconst KEY_EN = 13;\r\nconst KEY_TAB = 9;\r\n\r\n\r\nexport class MdbInputDirective {\r\n   public clearSelected = false;\r\n   public clearUnselected = false;\r\n   public overrideSuggested = false;\r\n   public fillHighlighted = true;\r\n   public openOnFocus = false;\r\n\r\n   public ngModelChange: EventEmitter<any> = new EventEmitter();\r\n\r\n  private _searchStr = '';\r\n  private _displayStr = '';\r\n  private blurTimer: Subscription = null;\r\n\r\n  constructor(  private completer: MdbCompleterDirective, private ngModel: NgModel, private el: ElementRef) {\r\n    this.completer.selected.subscribe((item: CompleterItem) => {\r\n      if (!item) {\r\n        return;\r\n      }\r\n      if (this.clearSelected) {\r\n        this.searchStr = '';\r\n      } else {\r\n        this.searchStr = item.title;\r\n      }\r\n      this.ngModelChange.emit(this.searchStr);\r\n    });\r\n    this.completer.highlighted.subscribe((item: CompleterItem) => {\r\n      if (this.fillHighlighted) {\r\n        if (item) {\r\n          this._displayStr = item.title;\r\n          this.ngModelChange.emit(item.title);\r\n        } else {\r\n          this._displayStr = this.searchStr;\r\n          this.ngModelChange.emit(this.searchStr);\r\n        }\r\n      }\r\n    });\r\n    this.ngModel.valueChanges.subscribe(value => {\r\n      if (!isNil(value) && this._displayStr !== value) {\r\n        if (this.searchStr !== value) {\r\n          this.completer.search(value);\r\n        }\r\n        this.searchStr = value;\r\n      }\r\n    });\r\n  }\r\n\r\n  \r\n  public keyupHandler(event: any) {\r\n    if (event.keyCode === KEY_LF || event.keyCode === KEY_RT || event.keyCode === KEY_TAB) {\r\n      // do nothing\r\n      return;\r\n    }\r\n\r\n    if (event.keyCode === KEY_UP || event.keyCode === KEY_EN) {\r\n      event.preventDefault();\r\n    } else if (event.keyCode === KEY_DW) {\r\n      event.preventDefault();\r\n\r\n      this.completer.search(this.searchStr);\r\n    } else if (event.keyCode === KEY_ES) {\r\n      this.restoreSearchValue();\r\n      this.completer.clear();\r\n    } else {\r\n      if (this.searchStr) {\r\n        this.completer.open();\r\n      }\r\n    }\r\n  }\r\n\r\n  \r\n  public keydownHandler(event: any) {\r\n    if (event.keyCode === KEY_EN) {\r\n      if (this.completer.hasHighlighted()) {\r\n        event.preventDefault();\r\n      }\r\n      this.handleSelection();\r\n    } else if (event.keyCode === KEY_DW) {\r\n      event.preventDefault();\r\n      this.completer.open();\r\n      this.completer.nextRow();\r\n    } else if (event.keyCode === KEY_UP) {\r\n      event.preventDefault();\r\n      this.completer.prevRow();\r\n    } else if (event.keyCode === KEY_TAB) {\r\n      this.handleSelection();\r\n    } else if (event.keyCode === KEY_ES) {\r\n      // This is very specific to IE10/11 #272\r\n      // without this, IE clears the input text\r\n      event.preventDefault();\r\n    }\r\n  }\r\n\r\n  \r\n  public onBlur(event: any) {\r\n    // Check if we need to cancel Blur for IE\r\n    if (this.completer.isCancelBlur()) {\r\n      setTimeout(\r\n        () => {\r\n          // get the focus back\r\n          this.el.nativeElement.focus();\r\n        },\r\n        0\r\n      );\r\n      return;\r\n    }\r\n    this.blurTimer = Observable.timer(200).subscribe(\r\n      () => {\r\n        this.blurTimer.unsubscribe();\r\n        this.blurTimer = null;\r\n        if (this.overrideSuggested) {\r\n          this.completer.onSelected({ title: this.searchStr, originalObject: null });\r\n        } else {\r\n          if (this.clearUnselected && !this.completer.hasSelected) {\r\n            this.searchStr = '';\r\n          } else {\r\n            this.restoreSearchValue();\r\n          }\r\n        }\r\n        this.completer.clear();\r\n      }\r\n    );\r\n  }\r\n\r\n  \r\n  public onfocus() {\r\n    if (this.blurTimer) {\r\n      this.blurTimer.unsubscribe();\r\n      this.blurTimer = null;\r\n    }\r\n    if (this.openOnFocus) {\r\n      this.completer.open();\r\n    }\r\n  }\r\n\r\n  public get searchStr() {\r\n    return this._searchStr;\r\n  }\r\n\r\n  public set searchStr(term: string) {\r\n    this._searchStr = term;\r\n    this._displayStr = term;\r\n  }\r\n\r\n  private handleSelection() {\r\n    if (this.completer.hasHighlighted()) {\r\n      this._searchStr = '';\r\n      this.completer.selectCurrent();\r\n    } else if (this.overrideSuggested) {\r\n      this.completer.onSelected({ title: this.searchStr, originalObject: null });\r\n    } else {\r\n      this.completer.clear();\r\n    }\r\n  }\r\n\r\n  private restoreSearchValue() {\r\n    if (this.fillHighlighted) {\r\n      if (this._displayStr !== this.searchStr) {\r\n        this._displayStr = this.searchStr;\r\n        this.ngModelChange.emit(this.searchStr);\r\n      }\r\n    }\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\r\n  selector: '[mdbInput]',\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: MdbCompleterDirective, decorators: [{ type: Host }, ]},\n{type: NgModel, },\n{type: ElementRef, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'clearSelected': [{ type: Input, args: ['clearSelected', ] },],\n'clearUnselected': [{ type: Input, args: ['clearUnselected', ] },],\n'overrideSuggested': [{ type: Input, args: ['overrideSuggested', ] },],\n'fillHighlighted': [{ type: Input, args: ['fillHighlighted', ] },],\n'openOnFocus': [{ type: Input, args: ['openOnFocus', ] },],\n'ngModelChange': [{ type: Output },],\n'keyupHandler': [{ type: HostListener, args: ['keyup', ['$event'], ] },],\n'keydownHandler': [{ type: HostListener, args: ['keydown', ['$event'], ] },],\n'onBlur': [{ type: HostListener, args: ['blur', ['$event'], ] },],\n'onfocus': [{ type: HostListener, args: ['focus', ['$event'], ] },],\n};\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}